# Changelog Configuration
# This file configures the valid values for changelog fields using the pivot structure.
# Place this file as `changelog.yml` in the `docs/` directory
#
# NOTE: All list-like fields accept BOTH forms:
#   - Comma-separated string: "value1, value2, value3"
#   - YAML list:
#     - value1
#     - value2
#     - value3
# Both forms produce the same result. Choose whichever is more readable for your use case.

# Products configuration (optional)
# If not specified, all products from products.yml are allowed
products:
  # List of available product IDs (empty = all from products.yml)
  # Accepts string or list: "elasticsearch, kibana" or [elasticsearch, kibana]
  available:
    - cloud-serverless
  # Default products when --products not specified
  # default:
  #   - product: elasticsearch
  #     lifecycle: ga

# Extraction configuration
# Controls automatic extraction of information from PR descriptions
extract:
  # Auto-extract release notes from PR descriptions (default: true)
  # Can be overridden by CLI --no-extract-release-notes
  release_notes: true
  # Auto-extract issues from PR body (default: true)
  # Looks for patterns like "Fixes #123", "Closes #456", etc.
  issues: true

# Available lifecycle values (strongly typed: preview, beta, ga)
# Accepts string or list: "preview, beta, ga" or a YAML list
lifecycles:
  - preview
  - beta
  - ga

# Pivot configuration for types, subtypes, and areas with label mappings.
# By default we render entries grouped by type > subtype > area.
# NOTE: subtype and area are optional and either may be omitted.
# Labels are specified in a "label -> value" format
# pivot:
  # Type definitions with optional labels
  # At a minimum, feature, bug-fix, and breaking-change must be configured.
  # Keys are type names, values can be:
  #   - simple string: comma-separated label list (e.g., ">bug, >fix")
  #   - YAML list: [">bug", ">fix"]
  #   - empty/null: no labels for this type
  #   - object: { labels: "...", subtypes: {...} } for breaking-change type only
  #     (labels and subtype values also accept string or list)
  # types:
    # Complex object form with subtypes (ONLY allowed for breaking-change)
    # Subtypes help categorize breaking changes by their nature
    # Both labels and subtype values accept string or list form
    # breaking-change:
      # labels: ">breaking, >bc"
      # Equivalent list form:
      # labels:
      #   - ">breaking"
      #   - ">bc"
      # subtypes:
      #   api: ">api-breaking"
      #   behavioral: ">behavioral-breaking"
      #   configuration: ">config-breaking"
      #   dependency: ">dependency-breaking"
      #   subscription: ">subscription-breaking"
      #   plugin: ">plugin-breaking"
      #   security: ">security-breaking"
      #   other:
    # Simple string form: labels as comma-separated string
    # bug-fix: ">bug"
    # deprecation: ">deprecation"
    # # Empty block: no labels (YAML null)
    # feature:
    # enhancement:
    # docs:
    # known-issue:
    # other:
    # regression:
    # security:

  # Labels that trigger the highlight flag (accepts string or list)
  # String form: highlight: ">highlight, >release-highlight"
  # List form:
  # highlight:
  #   - ">highlight"
  #   - ">release-highlight"

  # Area definitions with labels
  # Keys are area display names, values are label strings or lists
  # String form: "label1, label2" | List form: [label1, label2]
  # areas:
    # Example mappings - customize based on your label naming conventions
    # Autoscaling: ":Distributed Coordination/Autoscaling"
    # Search: ":Search/Search"
    # Security: ":Security/Security"
    # Watcher: ":Data Management/Watcher"
    # List form example:
    # Search:
    #   - ":Search/Search"
    #   - ":Search/Ranking"

# Rules configuration — controls which PRs create changelogs and which entries are published.
# All list-like fields (exclude, include, exclude_types, etc.) accept BOTH forms:
#   - Comma-separated string: "value1, value2, value3"
#   - YAML list: [value1, value2, value3]
#
# Global match default for multi-valued fields (labels, areas).
#   any (default) = match if ANY item matches the list
#   all           = match only if ALL items match the list
# Inherited by create, publish, and all product overrides.
rules:
  # match: any

  # Create — controls which PRs generate changelog entries.
  #   exclude: block PRs with these labels (string or list)
  #   include: only create changelogs for PRs with these labels (string or list)
  # Cannot specify both.
  #
  # create:
  #   exclude: ">non-issue, >test"
  #   # Or equivalently:
  #   # exclude:
  #   #   - ">non-issue"
  #   #   - ">test"
  #   # match: any
  #   products:
  #     'elasticsearch, kibana':
  #       exclude: ">test"
  #     'cloud-serverless':
  #       exclude: "ILM"

  # Publish — controls which entries appear in rendered output.
  #   exclude_types / include_types (string or list)
  #   exclude_areas / include_areas (string or list)
  # Cannot mix exclude_ and include_ for the same field.
  #
  # match_areas inherits from rules.match if not specified.
  #
  publish:
  #   # match_areas: any
    exclude_types: "docs"
  #   # Or equivalently:
  #   # exclude_types:
  #   #   - deprecation
  #   #   - known-issue
  #   exclude_areas:
  #     - "Internal"
    products:
  #     'elasticsearch, kibana':
  #       exclude_types:
  #         - docs
      'cloud-serverless':
        match_areas: any
        exclude_areas:
          - Allocation
          - Audit
          - Authentication
          - Autoscaling
          - CCR
          - CCS
          - "Cluster coordination"
          - Codec
          - "Discovery-Plugins"
          - Engine
          - FIPS
          - Health
          - ILM
          - IdentityProvider
          - "Infra/Circuit breakers"
          - "Infra/CLI"
          - "Infra/Core"
          - "Infra/Entitlements"
          - "Infra/Logging"
          - "Infra/Metrics"
          - "Infra/Node lifecycle"
          - "Infra/Plugins"
          - "Infra/Transport API"
          - License
          - Monitoring
          - Packaging
          - "Searchable snapshots"
          - SLM
          - "Snapshot and restore"
          - Stats
          - Watcher
        exclude_types:
          - docs
  #       include_areas:
  #         - "Search"
  #         - "Monitoring"

# Bundle configuration (profiles and defaults)
bundle:
  # Input directory containing changelog YAML files
  directory: changelog
  # Output directory for bundled changelog files
  output_directory: releases
  # Whether to resolve (copy contents) by default
  resolve: true

  # Named bundle profiles for different release scenarios
  # profiles:
    # Example: Elasticsearch release profile
    # elasticsearch-release:
    #   products: "elasticsearch {version} {lifecycle}"
    #   output: "elasticsearch-{version}.yaml"

    # Example: Serverless release profile
    # serverless-release:
    #   products: "cloud-serverless {version} *"
    #   output: "serverless-{version}.yaml"
    #   # Feature IDs to hide when bundling with this profile (accepts string or list)
    #   hide_features:
    #     - feature-flag-1
    #     - feature-flag-2
