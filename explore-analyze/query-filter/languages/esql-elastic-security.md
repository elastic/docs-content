---
applies:
  stack:
  serverless:
navigation_title: "Using {{esql}} in {{elastic-sec}}"
mapped_pages:
  - https://www.elastic.co/guide/en/elasticsearch/reference/current/esql-elastic-security.html
---



# Using ES|QL in Elastic Security [esql-elastic-security]


You can use {{esql}} in {{elastic-sec}} to investigate events in Timeline and create detection rules. Use the Elastic AI Assistant to build {{esql}} queries, or answer questions about the {{esql}} query language.


## Use {{esql}} to investigate events in Timeline [esql-elastic-security-timeline]

You can use {{esql}} in Timeline to filter, transform, and analyze event data stored in {{es}}. To start using {{esql}}, open the **{{esql}}** tab. To learn more, refer to [Investigate events in Timeline](../../../solutions/security/investigate/timeline.md#esql-in-timeline).


## Use {{esql}} to create detection rules [esql-elastic-security-detection-rules]

Use the {{esql}} rule type to create detection rules using {{esql}} queries. The {{esql}} rule type supports aggregating and non-aggregating queries. To learn more, refer to [Create an {{esql}} rule](../../../solutions/security/detect-and-alert/create-detection-rule.md#create-esql-rule).


## Elastic AI Assistant [esql-elastic-security-ai-assistant]

Use the Elastic AI Assistant to build {{esql}} queries, or answer questions about the {{esql}} query language. To learn more, refer to [AI Assistant](../../../solutions/security/ai/ai-assistant.md).
